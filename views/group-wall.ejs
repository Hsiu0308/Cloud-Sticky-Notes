<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include ("partials/header") %>
    <title><%= group.title %> - ç‰†é¢</title>
    <style>
      body {
        background-color: #e9ecef;
      }

      /* ç¾¤çµ„è³‡è¨Šå¡ç‰‡ */
      section.group-info {
        background-color: white;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        border-radius: 0.5rem;
      }
      .group-header-container {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }
      .group-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #fff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      @media (max-width: 768px) {
        .group-header-container {
          flex-direction: column;
          text-align: center;
        }
        .action-buttons {
          width: 100%;
          justify-content: center;
          margin-top: 1rem;
        }
      }

      /* --- ä¾¿åˆ©è²¼æ¨£å¼ --- */
      .sticky-note {
        background-color: #fdfd86;
        width: 100%;
        min-height: 220px;
        padding: 1.2rem;
        position: relative;
        box-shadow: 5px 5px 7px rgba(33, 33, 33, 0.2);
        font-family: "Comic Sans MS", "Chalkboard SE", sans-serif;
        transition: transform 0.15s linear; /* è¨­å®šå‹•ç•«æ™‚é–“ */

        /* é è¨­ç‹€æ…‹ (å¥‡æ•¸)ï¼šå‘å·¦æ­ª */
        transform: rotate(-1deg);
      }

      /* å¶æ•¸ç‹€æ…‹ï¼šå‘å³æ­ª */
      div[class*="col-"]:nth-child(even) .sticky-note {
        transform: rotate(1deg);
        position: relative;
        top: 5px;
      }

      /* --- â–¼â–¼â–¼ ä¿®æ­£é‡é»ï¼šåˆ†åˆ¥è¨­å®š Hover æ•ˆæœ â–¼â–¼â–¼ --- */

      /* 1. å¥‡æ•¸å¼µ Hoverï¼šæ”¾å¤§ 1.05 å€ï¼Œä¸¦ä¿æŒå·¦æ­ª */
      div[class*="col-"] .sticky-note:hover {
        transform: scale(1.05) rotate(-1deg);
        box-shadow: 10px 10px 15px rgba(33, 33, 33, 0.3); /* é™°å½±åŠ æ·± */
        z-index: 10;
        cursor: pointer;
      }

      /* 2. å¶æ•¸å¼µ Hoverï¼šæ”¾å¤§ 1.05 å€ï¼Œä¸¦ä¿æŒå³æ­ª */
      div[class*="col-"]:nth-child(even) .sticky-note:hover {
        transform: scale(1.05) rotate(1deg);
      }

      /* --- â–²â–²â–² ä¿®æ­£çµæŸ â–²â–²â–² --- */

      /* æ‰‹æ©Ÿç‰ˆ RWDï¼šå¼·åˆ¶è½‰æ­£ï¼Œå–æ¶ˆæ­ªæ–œ */
      @media (max-width: 768px) {
        .sticky-note {
          transform: rotate(0deg) !important;
        }
        div[class*="col-"]:nth-child(even) .sticky-note {
          transform: rotate(0deg) !important;
          top: 0;
        }
        /* æ‰‹æ©Ÿç‰ˆ Hoverï¼šåªæ”¾å¤§ï¼Œä¸æ—‹è½‰ */
        div[class*="col-"] .sticky-note:hover,
        div[class*="col-"]:nth-child(even) .sticky-note:hover {
          transform: scale(1.02) rotate(0deg);
        }
      }

      .sticky-note.yellow {
        background-color: #fdfd86;
      }
      .sticky-note.blue {
        background-color: #a6dcef;
      }
      .sticky-note.green {
        background-color: #caf0b6;
      }
      .sticky-note.pink {
        background-color: #ffccdb;
      }

      .note-author {
        font-size: 0.85rem;
        color: #666;
        font-weight: bold;
        margin-bottom: 5px;
        display: block;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }
      .note-content {
        white-space: pre-wrap;
        height: 100px;
        overflow-y: auto;
      }
    </style>
  </head>
  <body>
    <%- include ("partials/nav") %>

    <div class="container mt-4">
      <section class="group-info">
        <div class="group-header-container">
          <img
            class="group-avatar"
            src="https://cdn.pixabay.com/photo/2016/11/14/17/39/group-1824145_1280.png"
            alt="Group Icon"
          />

          <div class="flex-grow-1">
            <h2 class="mb-0"><%= group.title %> çš„ç¾¤çµ„ç‰†</h2>
            <small class="text-muted">
              é€šè¡Œç¢¼ï¼š<span class="badge bg-light text-dark border"
                ><%= group.passcode %></span
              >
              &nbsp;|&nbsp; æˆå“¡ï¼š<%= group.members.length %> äºº
            </small>
          </div>

          <div class="d-flex gap-2 action-buttons">
            <a
              href="/groups/<%= group._id %>/post"
              class="btn btn-warning fw-bold shadow-sm"
            >
              âœï¸ è²¼æ–°ä¾¿åˆ©è²¼
            </a>
            <a href="/groups" class="btn btn-outline-secondary">å›å¤§å»³</a>
          </div>
        </div>
      </section>

      <div class="row">
        <% posts.forEach(post => { %>
        <div class="col-12 col-sm-6 col-lg-3 mb-4">
          <div class="sticky-note <%= post.color || 'yellow' %>">
            <span class="note-author"
              >ğŸ‘¤ <%= post.authorName || 'æŸä½æˆå“¡' %></span
            >
            <div class="fw-bold fs-5 mt-1"><%= post.title %></div>
            <div class="note-content mt-2"><%= post.content %></div>
            <small class="text-muted position-absolute bottom-0 end-0 p-3">
              <%= post.date.toLocaleDateString("zh-TW", { timeZone:
              "Asia/Taipei" }) %>
            </small>
          </div>
        </div>
        <% }) %> <% if (posts.length === 0) { %>
        <div class="text-center text-muted mt-5">
          <h3>ç‰†ä¸Šé‚„æ²’æœ‰æ±è¥¿ï¼Œæ¶é ­é¦™ï¼</h3>
        </div>
        <% } %>
      </div>
    </div>
  </body>
</html>
