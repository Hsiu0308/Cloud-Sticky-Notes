<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include ("partials/header") %>
    <title>æˆ‘çš„ä¾¿åˆ©è²¼ç‰†</title>
    <style>
      body {
        background-color: #e9ecef;
      }

      /* --- å€‹äººè³‡è¨Šå¡ç‰‡ (æ¨£å¼èˆ‡ Group çµ±ä¸€) --- */
      section.user-info {
        background-color: white;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        border-radius: 0.5rem;
      }
      .user-header-container {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }
      .user-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #fff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      /* æ‰‹æ©Ÿç‰ˆ RWDï¼šæŒ‰éˆ•æ›è¡Œ */
      @media (max-width: 768px) {
        .user-header-container {
          flex-direction: column;
          text-align: center;
        }
        .action-buttons {
          width: 100%;
          justify-content: center;
          margin-top: 1rem;
        }
      }

      /* --- ä¾¿åˆ©è²¼æ¨£å¼ --- */
      .posts-container {
        padding: 2rem;
      }

      .sticky-note {
        background-color: #fdfd86;
        width: 100%;
        min-height: 250px;
        padding: 1.5rem;
        position: relative;
        box-shadow: 5px 5px 7px rgba(33, 33, 33, 0.2);
        font-family: "Comic Sans MS", "Chalkboard SE", sans-serif;
        transition: transform 0.15s linear;

        /* é è¨­ç‹€æ…‹ (å¥‡æ•¸)ï¼šå‘å·¦æ­ª */
        transform: rotate(-1deg);
      }

      /* å¶æ•¸ç‹€æ…‹ï¼šå‘å³æ­ª */
      div[class*="col-"]:nth-child(even) .sticky-note {
        transform: rotate(1deg);
        position: relative;
        top: 5px;
      }

      /* Hover æ•ˆæœ */
      div[class*="col-"] .sticky-note:hover {
        transform: scale(1.05) rotate(-1deg);
        box-shadow: 10px 10px 15px rgba(33, 33, 33, 0.3);
        z-index: 10;
        cursor: pointer;
      }
      div[class*="col-"]:nth-child(even) .sticky-note:hover {
        transform: scale(1.05) rotate(1deg);
      }

      /* æ‰‹æ©Ÿç‰ˆ RWDï¼šå¼·åˆ¶è½‰æ­£ */
      @media (max-width: 768px) {
        .posts-container {
          padding: 1rem;
        }
        .sticky-note {
          transform: rotate(0deg) !important;
        }
        div[class*="col-"]:nth-child(even) .sticky-note {
          transform: rotate(0deg) !important;
          top: 0;
        }

        div[class*="col-"] .sticky-note:hover,
        div[class*="col-"]:nth-child(even) .sticky-note:hover {
          transform: scale(1.02) rotate(0deg);
        }
      }

      .note-title {
        font-weight: bold;
        font-size: 1.4rem;
        margin-bottom: 1rem;
        border-bottom: 2px dashed rgba(0, 0, 0, 0.1);
        padding-bottom: 0.5rem;
        color: #333;
      }
      .note-content {
        font-size: 1.1rem;
        color: #555;
        height: 120px;
        overflow-y: auto;
        margin-bottom: 1rem;
        white-space: pre-wrap;
      }
      .note-actions {
        position: absolute;
        bottom: 15px;
        right: 15px;
        left: 15px;
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
      }
      .note-date {
        font-size: 0.8rem;
        color: #888;
      }

      .action-btn {
        font-size: 0.9rem;
        text-decoration: none;
        padding: 2px 8px;
        border-radius: 4px;
        transition: 0.2s;
      }
      .edit-btn {
        color: #555;
      }
      .edit-btn:hover {
        background-color: rgba(0, 0, 0, 0.05);
        color: #000;
      }
      .delete-btn {
        color: #d9534f;
      }
      .delete-btn:hover {
        background-color: rgba(217, 83, 79, 0.1);
      }

      /* é¡è‰²å®šç¾© */
      .sticky-note.yellow {
        background-color: #fdfd86;
      }
      .sticky-note.blue {
        background-color: #a6dcef;
      }
      .sticky-note.green {
        background-color: #caf0b6;
      }
      .sticky-note.pink {
        background-color: #ffccdb;
      }
    </style>
  </head>
  <body>
    <%- include ("partials/nav") %>

    <div class="container mt-4">
      <section class="user-info">
        <div class="user-header-container">
          <img
            class="user-avatar"
            src="<%= user.thumbnail || 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png' %>"
            alt="Avatar"
          />

          <div class="flex-grow-1">
            <h2 class="mb-0"><%= user.name %> çš„ä¾¿åˆ©è²¼ç‰†</h2>
            <small class="text-muted">
              <% if (user.googleID) { %> ID:
              <span class="badge bg-light text-dark border">Google å¸³è™Ÿ</span>
              <% } else { %> ID:
              <span class="badge bg-light text-dark border">æœ¬åœ°å¸³è™Ÿ</span>
              <% } %> &nbsp;|&nbsp; å·²å¼µè²¼ï¼š<%= posts.length %> å¼µ
            </small>
          </div>

          <div class="action-buttons">
            <a href="/profile/post" class="btn btn-warning fw-bold shadow-sm">
              âœï¸ è²¼æ–°ä¾¿åˆ©è²¼
            </a>
          </div>
        </div>
      </section>
      <section class="posts-container">
        <div class="row">
          <% for (let i = 0; i < posts.length; i++) { %>
          <div class="col-12 col-sm-6 col-lg-4 mb-4 mb-md-5">
            <div class="sticky-note <%= posts[i].color || 'yellow' %>">
              <div class="note-title"><%= posts[i].title %></div>
              <div class="note-content"><%= posts[i].content %></div>

              <div class="note-actions">
                <span class="note-date">
                  <%= posts[i].date.toLocaleDateString("zh-TW", { timeZone:
                  "Asia/Taipei" }) %>
                </span>

                <div>
                  <a
                    href="/profile/post/edit/<%= posts[i]._id %>"
                    class="action-btn edit-btn"
                    >âœï¸ ç·¨è¼¯</a
                  >
                  <a
                    href="/profile/post/delete/<%= posts[i]._id %>"
                    class="action-btn delete-btn"
                    onclick="return confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ');"
                    >ğŸ—‘ï¸</a
                  >
                </div>
              </div>
            </div>
          </div>
          <% } %> <% if (posts.length === 0) { %>
          <div class="col-12 text-center mt-5">
            <h3 class="text-muted">ç‰†ä¸Šä¸€ç‰‡ç©ºç™½...</h3>
            <a href="/profile/post" class="btn btn-warning btn-lg mt-3 shadow"
              >è²¼ä¸Šç¬¬ä¸€å¼µä¾¿åˆ©è²¼ï¼</a
            >
          </div>
          <% } %>
        </div>
      </section>
    </div>
  </body>
</html>
